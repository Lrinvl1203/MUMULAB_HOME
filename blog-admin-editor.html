<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”’ Blog Admin Editor - MUMULAB</title>
    <meta name="robots" content="noindex, nofollow">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="admin-auth.js"></script>
    <style>
        /* ë¦¬ì¹˜ í…ìŠ¤íŠ¸ ì—ë””í„° ìŠ¤íƒ€ì¼ */
        .editor-toolbar {
            border-bottom: 1px solid #e5e7eb;
            padding: 0.5rem;
            background: #f9fafb;
            border-radius: 0.5rem 0.5rem 0 0;
        }

        .editor-content {
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 0.5rem 0.5rem;
            background: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
        }

        .editor-content:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* í”„ë¦¬ë·° ìŠ¤íƒ€ì¼ */
        .preview-content {
            background: white;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            line-height: 1.6;
        }

        .preview-content h1, .preview-content h2, .preview-content h3 {
            color: #2563eb;
            margin-bottom: 1rem;
            margin-top: 1.5rem;
        }

        .preview-content h1 { font-size: 2rem; font-weight: bold; }
        .preview-content h2 { font-size: 1.5rem; font-weight: bold; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.5rem; }
        .preview-content h3 { font-size: 1.25rem; font-weight: bold; }

        .preview-content p { margin-bottom: 1rem; }
        .preview-content ul, .preview-content ol { margin: 1rem 0 1rem 1.5rem; }
        .preview-content li { margin-bottom: 0.5rem; }

        /* ì¸ì¦ ëª¨ë‹¬ */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .auth-modal.hidden {
            display: none;
        }

        /* í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ í‘œì‹œ */
        .shortcut-hint {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .shortcut-hint.show {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- ì¸ì¦ ëª¨ë‹¬ì€ admin-auth.jsì—ì„œ ë™ì  ìƒì„± -->

    <!-- í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ íŒíŠ¸ -->
    <div id="shortcutHint" class="shortcut-hint">
        Ctrl + Alt + A: ê´€ë¦¬ì ëª¨ë“œ
    </div>

    <!-- ë©”ì¸ ì—ë””í„° -->
    <div id="adminEditor" class="hidden">
        <div class="container mx-auto px-4 py-8">
            <!-- í—¤ë” -->
            <header class="mb-8">
                <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4">
                    <strong>ğŸ”’ ê´€ë¦¬ì ì „ìš© ë¸”ë¡œê·¸ ì—ë””í„°</strong> - ì´ í˜ì´ì§€ëŠ” ì¸ì¦ëœ ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                </div>

                <div class="flex justify-between items-center">
                    <h1 class="text-3xl font-bold text-gray-800">ğŸ“ ë¸”ë¡œê·¸ ê´€ë¦¬ì ì—ë””í„°</h1>
                    <div class="flex gap-2">
                        <button onclick="showBlogList()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition-colors">
                            ğŸ“‹ ê¸€ ëª©ë¡
                        </button>
                        <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors">
                            ğŸšª ë¡œê·¸ì•„ì›ƒ
                        </button>
                    </div>
                </div>
            </header>

            <!-- íƒ­ ë©”ë‰´ -->
            <div class="mb-6">
                <div class="border-b border-gray-200">
                    <nav class="-mb-px flex space-x-8">
                        <button
                            id="editTab"
                            onclick="switchTab('edit')"
                            class="py-2 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600"
                        >
                            âœï¸ í¸ì§‘
                        </button>
                        <button
                            id="previewTab"
                            onclick="switchTab('preview')"
                            class="py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700"
                        >
                            ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°
                        </button>
                        <button
                            id="listTab"
                            onclick="switchTab('list')"
                            class="py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700"
                        >
                            ğŸ“‹ ê¸€ ëª©ë¡
                        </button>
                    </nav>
                </div>
            </div>

            <!-- í¸ì§‘ íŒ¨ë„ -->
            <div id="editPanel" class="grid lg:grid-cols-2 gap-6">
                <!-- ë©”íƒ€ë°ì´í„° ì…ë ¥ -->
                <div class="space-y-4">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold mb-4">ğŸ“Š í¬ìŠ¤íŠ¸ ì •ë³´</h3>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ì œëª©</label>
                                <input
                                    type="text"
                                    id="postTitle"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                                >
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</label>
                                <select id="postCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="AIìƒì‚°ì„±">AI ìƒì‚°ì„±</option>
                                    <option value="ì‹œê°„ê´€ë¦¬">ì‹œê°„ê´€ë¦¬</option>
                                    <option value="ëª¨ë°”ì¼AI">ëª¨ë°”ì¼ AI</option>
                                    <option value="ìŒì„±AI">ìŒì„± AI</option>
                                    <option value="ì»¤ë®¤ë‹ˆì¼€ì´ì…˜">ì»¤ë®¤ë‹ˆì¼€ì´ì…˜</option>
                                    <option value="ì •ë³´ì²˜ë¦¬">ì •ë³´ì²˜ë¦¬</option>
                                    <option value="ê°œì¸í™”AI">ê°œì¸í™” AI</option>
                                    <option value="ì–¸ì–´AI">ì–¸ì–´ AI</option>
                                    <option value="ì°½ì‘AI">ì°½ì‘ AI</option>
                                    <option value="ë°ì´í„°ë¶„ì„">ë°ì´í„°ë¶„ì„</option>
                                    <option value="ìë™í™”">ìë™í™”</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">íƒœê·¸ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                                <input
                                    type="text"
                                    id="postTags"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="AI, ìƒì‚°ì„±, ìë™í™”"
                                >
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ë‚œì´ë„</label>
                                <select id="postDifficulty" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="ì´ˆê¸‰">ì´ˆê¸‰</option>
                                    <option value="ì¤‘ê¸‰">ì¤‘ê¸‰</option>
                                    <option value="ê³ ê¸‰">ê³ ê¸‰</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ìš”ì•½</label>
                                <textarea
                                    id="postSummary"
                                    rows="3"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="í¬ìŠ¤íŠ¸ ìš”ì•½ì„ ì‘ì„±í•˜ì„¸ìš” (SEO ë©”íƒ€ ì„¤ëª…ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤)"
                                ></textarea>
                            </div>
                        </div>

                        <div class="mt-6 flex gap-3">
                            <button onclick="savePost()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors">
                                ğŸ’¾ ì €ì¥
                            </button>
                            <button onclick="publishPost()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                                ğŸš€ ë°œí–‰
                            </button>
                            <button onclick="clearEditor()" class="bg-gray-400 text-white py-2 px-4 rounded-md hover:bg-gray-500 transition-colors">
                                ğŸ—‘ï¸ ì´ˆê¸°í™”
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ì—ë””í„° -->
                <div class="space-y-4">
                    <div class="bg-white rounded-lg shadow">
                        <!-- íˆ´ë°” -->
                        <div class="editor-toolbar">
                            <div class="flex flex-wrap gap-2">
                                <button onclick="formatText('bold')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    <strong>B</strong>
                                </button>
                                <button onclick="formatText('italic')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    <em>I</em>
                                </button>
                                <button onclick="formatText('insertUnorderedList')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    â€¢ ëª©ë¡
                                </button>
                                <button onclick="formatText('insertOrderedList')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    1. ë²ˆí˜¸
                                </button>
                                <button onclick="insertHeading(2)" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    H2
                                </button>
                                <button onclick="insertHeading(3)" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    H3
                                </button>
                                <button onclick="insertTemplate()" class="px-3 py-1 bg-blue-200 hover:bg-blue-300 rounded text-sm">
                                    ğŸ“‹ í…œí”Œë¦¿
                                </button>
                            </div>
                        </div>

                        <!-- ì—ë””í„° -->
                        <div
                            id="contentEditor"
                            class="editor-content"
                            contenteditable="true"
                            data-placeholder="ì—¬ê¸°ì— ë¸”ë¡œê·¸ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”..."
                        ></div>
                    </div>
                </div>
            </div>

            <!-- ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ -->
            <div id="previewPanel" class="hidden">
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="preview-content" id="previewContent">
                        <h1>ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”</h1>
                        <div class="text-gray-600 mb-4 border-b pb-4">
                            <span>ğŸ“… 2024-09-23</span> |
                            <span>ğŸ“‚ ì¹´í…Œê³ ë¦¬</span> |
                            <span>â­ ë‚œì´ë„</span>
                        </div>
                        <p>ë‚´ìš©ì„ ì‘ì„±í•˜ë©´ ì—¬ê¸°ì— ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>

            <!-- ê¸€ ëª©ë¡ íŒ¨ë„ -->
            <div id="listPanel" class="hidden">
                <div class="bg-white rounded-lg shadow">
                    <!-- í—¤ë” ë° ê²€ìƒ‰ -->
                    <div class="p-6 border-b">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold">ğŸ“‹ ì €ì¥ëœ ë¸”ë¡œê·¸ ê¸€</h3>
                            <div class="flex gap-2">
                                <button onclick="toggleSelectAll()" id="selectAllBtn" class="bg-gray-500 text-white px-3 py-2 rounded hover:bg-gray-600 transition-colors text-sm">
                                    â˜‘ï¸ ì „ì²´ì„ íƒ
                                </button>
                                <button onclick="bulkDelete()" id="bulkDeleteBtn" class="bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600 transition-colors text-sm hidden">
                                    ğŸ—‘ï¸ ì„ íƒì‚­ì œ
                                </button>
                                <button onclick="importExistingBlogFiles()" class="bg-green-500 text-white px-3 py-2 rounded hover:bg-green-600 transition-colors text-sm">
                                    ğŸ“¥ ê¸°ì¡´íŒŒì¼
                                </button>
                                <button onclick="refreshBlogList()" class="bg-blue-500 text-white px-3 py-2 rounded hover:bg-blue-600 transition-colors text-sm">
                                    ğŸ”„ ìƒˆë¡œê³ ì¹¨
                                </button>
                                <button onclick="addSamplePost()" class="bg-purple-500 text-white px-3 py-2 rounded hover:bg-purple-600 transition-colors text-sm">
                                    â• í…ŒìŠ¤íŠ¸ê¸€
                                </button>
                            </div>
                        </div>

                        <!-- ê²€ìƒ‰ ë° í•„í„° -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ” ê²€ìƒ‰</label>
                                <input type="text" id="searchInput" placeholder="ì œëª©ìœ¼ë¡œ ê²€ìƒ‰..."
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                       onkeyup="filterPosts()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“‚ ì¹´í…Œê³ ë¦¬</label>
                                <select id="categoryFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" onchange="filterPosts()">
                                    <option value="">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option>
                                    <option value="AIìƒì‚°ì„±">AIìƒì‚°ì„±</option>
                                    <option value="ì‹œê°„ê´€ë¦¬">ì‹œê°„ê´€ë¦¬</option>
                                    <option value="ì»¤ë®¤ë‹ˆì¼€ì´ì…˜">ì»¤ë®¤ë‹ˆì¼€ì´ì…˜</option>
                                    <option value="ëª¨ë°”ì¼AI">ëª¨ë°”ì¼AI</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“‹ ìƒíƒœ</label>
                                <select id="statusFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" onchange="filterPosts()">
                                    <option value="">ëª¨ë“  ìƒíƒœ</option>
                                    <option value="draft">ì„ì‹œì €ì¥</option>
                                    <option value="published">ë°œí–‰ë¨</option>
                                </select>
                            </div>
                        </div>

                        <!-- í†µê³„ ì •ë³´ -->
                        <div class="mt-4 grid grid-cols-3 gap-4 text-center">
                            <div class="bg-blue-50 p-3 rounded-lg">
                                <div class="text-lg font-bold text-blue-600" id="totalCount">0</div>
                                <div class="text-sm text-blue-600">ì „ì²´</div>
                            </div>
                            <div class="bg-green-50 p-3 rounded-lg">
                                <div class="text-lg font-bold text-green-600" id="publishedCount">0</div>
                                <div class="text-sm text-green-600">ë°œí–‰ë¨</div>
                            </div>
                            <div class="bg-gray-50 p-3 rounded-lg">
                                <div class="text-lg font-bold text-gray-600" id="draftCount">0</div>
                                <div class="text-sm text-gray-600">ì„ì‹œì €ì¥</div>
                            </div>
                        </div>
                    </div>

                    <!-- ê¸€ ëª©ë¡ -->
                    <div id="blogListContainer" class="p-6">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ê´€ë¦¬ì ì¸ì¦ ì„¤ì •
        const ADMIN_PASSWORD = 'mumulab2024!'; // ì‹¤ì œ ìš´ì˜ì‹œì—ëŠ” ë” ë³µì¡í•œ ì¸ì¦ ì‹œìŠ¤í…œ ì‚¬ìš©
        const AUTH_STORAGE_KEY = 'mumulab_admin_auth';
        const STORAGE_KEY = 'mumulab_blog_posts';

        // í˜„ì¬ í¸ì§‘ ì¤‘ì¸ í¬ìŠ¤íŠ¸ ID
        let currentPostId = null;

        // ê¸°ì¡´ í¬ìŠ¤íŠ¸ slug ë§ˆì´ê·¸ë ˆì´ì…˜
        function migratePostSlugs() {
            const posts = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            let migrated = false;

            posts.forEach(post => {
                // slugê°€ ì—†ê±°ë‚˜ admin- í˜•íƒœì¸ ê²½ìš° ìƒˆë¡œ ìƒì„±
                if (!post.slug || post.slug.startsWith('admin-')) {
                    const date = post.published || post.created;
                    post.slug = generateSlug(post.title, date);
                    migrated = true;
                }
            });

            if (migrated) {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(posts));
                console.log('í¬ìŠ¤íŠ¸ slug ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ');
            }
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            // í¬ìŠ¤íŠ¸ slug ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
            migratePostSlugs();

            // ê³µí†µ ì¸ì¦ ì‹œìŠ¤í…œ ì‚¬ìš©
            AdminAuth.protectAdminPage(function() {
                showAdminEditor();
                console.log('ğŸ” ë¸”ë¡œê·¸ ê´€ë¦¬ì ì—ë””í„° ë¡œë“œ ì™„ë£Œ');
            });

            // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì„¤ì •
            setupKeyboardShortcuts();

            // ì—ë””í„° ì´ë²¤íŠ¸ ì„¤ì •
            setupEditor();

            // ë¸”ë¡œê·¸ ëª©ë¡ ì´ˆê¸° ë¡œë“œ
            refreshBlogList();

            // íŒíŠ¸ í‘œì‹œ
            showShortcutHint();
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì„¤ì •
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ctrl + Alt + A: ê´€ë¦¬ì ëª¨ë“œ í† ê¸€
                if (e.ctrlKey && e.altKey && e.key === 'A') {
                    e.preventDefault();
                    if (isAuthenticated()) {
                        logout();
                    } else {
                        showAuthModal();
                    }
                }

                // ESC: ëª¨ë‹¬ ë‹«ê¸°
                if (e.key === 'Escape') {
                    closeAuthModal();
                }
            });
        }

        // ë‹¨ì¶•í‚¤ íŒíŠ¸ í‘œì‹œ
        function showShortcutHint() {
            const hint = document.getElementById('shortcutHint');
            hint.classList.add('show');

            setTimeout(() => {
                hint.classList.remove('show');
            }, 3000);
        }

        // ì¸ì¦ ìƒíƒœ í™•ì¸
        // ê³µí†µ ì¸ì¦ ì‹œìŠ¤í…œìœ¼ë¡œ ëŒ€ì²´ (admin-auth.js ì‚¬ìš©)

        // ê´€ë¦¬ì ì—ë””í„° í‘œì‹œ
        function showAdminEditor() {
            document.getElementById('adminEditor').classList.remove('hidden');
            refreshBlogList();
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            AdminAuth.logout();
        }

        // íƒ­ ì „í™˜
        function switchTab(tab) {
            // íƒ­ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('[id$="Tab"]').forEach(btn => {
                btn.className = btn.className.replace('border-blue-500 text-blue-600', 'border-transparent text-gray-500 hover:text-gray-700');
            });

            document.getElementById(tab + 'Tab').className = document.getElementById(tab + 'Tab').className.replace('border-transparent text-gray-500 hover:text-gray-700', 'border-blue-500 text-blue-600');

            // íŒ¨ë„ í‘œì‹œ/ìˆ¨ê¹€
            document.getElementById('editPanel').classList.toggle('hidden', tab !== 'edit');
            document.getElementById('previewPanel').classList.toggle('hidden', tab !== 'preview');
            document.getElementById('listPanel').classList.toggle('hidden', tab !== 'list');

            // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
            if (tab === 'preview') {
                updatePreview();
            }

            // ê¸€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            if (tab === 'list') {
                refreshBlogList();
            }
        }

        // ì—ë””í„° ì„¤ì •
        function setupEditor() {
            const editor = document.getElementById('contentEditor');

            // í”Œë ˆì´ìŠ¤í™€ë” ì²˜ë¦¬
            editor.addEventListener('focus', () => {
                if (editor.textContent.trim() === '') {
                    editor.innerHTML = '';
                }
            });

            editor.addEventListener('blur', () => {
                if (editor.textContent.trim() === '') {
                    editor.innerHTML = '';
                }
            });

            // ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
            editor.addEventListener('input', () => {
                if (document.getElementById('previewPanel').classList.contains('hidden') === false) {
                    updatePreview();
                }
            });
        }

        // í…ìŠ¤íŠ¸ í¬ë§·íŒ…
        function formatText(command) {
            document.execCommand(command, false, null);
            document.getElementById('contentEditor').focus();
        }

        // í—¤ë”© ì‚½ì…
        function insertHeading(level) {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                const heading = document.createElement('h' + level);
                heading.textContent = selection.toString() || 'ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”';

                range.deleteContents();
                range.insertNode(heading);

                // ì»¤ì„œë¥¼ í—¤ë”© ëìœ¼ë¡œ ì´ë™
                range.setStartAfter(heading);
                range.setEndAfter(heading);
                selection.removeAllRanges();
                selection.addRange(range);
            }
            document.getElementById('contentEditor').focus();
        }

        // í…œí”Œë¦¿ ì‚½ì…
        function insertTemplate() {
            const template = `<h2>ê°œìš”</h2>
<p>ì´ ê¸€ì—ì„œëŠ” [ì£¼ì œ]ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h2>ì£¼ìš” ê¸°ëŠ¥</h2>
<ul>
<li><strong>ê¸°ëŠ¥ 1</strong>: ì„¤ëª…</li>
<li><strong>ê¸°ëŠ¥ 2</strong>: ì„¤ëª…</li>
<li><strong>ê¸°ëŠ¥ 3</strong>: ì„¤ëª…</li>
</ul>

<h2>ì‹¤í–‰ ë‹¨ê³„</h2>

<h3>1ë‹¨ê³„: ì¤€ë¹„í•˜ê¸°</h3>
<p>ì²« ë²ˆì§¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…</p>

<h3>2ë‹¨ê³„: ì‹¤í–‰í•˜ê¸°</h3>
<p>ë‘ ë²ˆì§¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…</p>

<h3>3ë‹¨ê³„: ìµœì í™”</h3>
<p>ì„¸ ë²ˆì§¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…</p>

<h2>ì£¼ì˜ì‚¬í•­</h2>
<ul>
<li>âš ï¸ ì£¼ì˜í•´ì•¼ í•  ì </li>
<li>ğŸ’¡ ìœ ìš©í•œ íŒ</li>
<li>ğŸ”§ ë¬¸ì œ í•´ê²° ë°©ë²•</li>
</ul>

<h2>ë§ˆë¬´ë¦¬</h2>
<p>ì´ ê¸€ì—ì„œ ì†Œê°œí•œ ë°©ë²•ì„ í†µí•´ [ëª©í‘œ]ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>`;

            document.getElementById('contentEditor').innerHTML = template;
        }

        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updatePreview() {
            const title = document.getElementById('postTitle').value || 'ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”';
            const category = document.getElementById('postCategory').value;
            const difficulty = document.getElementById('postDifficulty').value;
            const content = document.getElementById('contentEditor').innerHTML;

            const previewContent = document.getElementById('previewContent');
            const today = new Date().toLocaleDateString('ko-KR');

            previewContent.innerHTML = `
                <h1>${title}</h1>
                <div class="text-gray-600 mb-4 border-b pb-4">
                    <span>ğŸ“… ${today}</span> |
                    <span>ğŸ“‚ ${category}</span> |
                    <span>â­ ${difficulty}</span>
                </div>
                ${content || '<p>ë‚´ìš©ì„ ì‘ì„±í•˜ë©´ ì—¬ê¸°ì— ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>'}
            `;
        }

        // íŒŒì¼ëª… ìƒì„± í•¨ìˆ˜
        function generateSlug(title, date) {
            const formattedDate = new Date(date).toISOString().split('T')[0];
            const cleanTitle = title.replace(/[^a-zA-Z0-9ê°€-í£\s]/g, '').replace(/\s+/g, '-');
            return `${formattedDate}-${cleanTitle}`;
        }

        // í¬ìŠ¤íŠ¸ ì €ì¥
        function savePost() {
            const title = document.getElementById('postTitle').value;
            const postData = {
                id: currentPostId || Date.now().toString(),
                title: title,
                category: document.getElementById('postCategory').value,
                tags: document.getElementById('postTags').value.split(',').map(tag => tag.trim()),
                difficulty: document.getElementById('postDifficulty').value,
                summary: document.getElementById('postSummary').value,
                content: document.getElementById('contentEditor').innerHTML,
                created: currentPostId ? getPost(currentPostId)?.created || new Date().toISOString() : new Date().toISOString(),
                updated: new Date().toISOString(),
                status: 'draft'
            };

            // slug ìƒì„± (íŒŒì¼ëª…ê³¼ ì¼ì¹˜í•˜ë„ë¡)
            postData.slug = generateSlug(title, postData.created);

            if (!postData.title.trim()) {
                alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            savePostToStorage(postData);
            currentPostId = postData.id;

            alert('í¬ìŠ¤íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            refreshBlogList();
        }

        // í¬ìŠ¤íŠ¸ ë°œí–‰
        async function publishPost() {
            savePost(); // ë¨¼ì € ì €ì¥

            if (currentPostId) {
                const post = getPost(currentPostId);
                if (post) {
                    post.status = 'published';
                    post.published = new Date().toISOString();

                    // ë°œí–‰ ì‹œ slug ì—…ë°ì´íŠ¸ (ë°œí–‰ ë‚ ì§œ ê¸°ì¤€)
                    post.slug = generateSlug(post.title, post.published);

                    savePostToStorage(post);

                    // HTML íŒŒì¼ ìƒì„±
                    await generateHTMLFile(post);

                    showPublishSuccess(post.slug + '.html');
                    refreshBlogList();
                }
            }
        }

        // HTML íŒŒì¼ ìƒì„± ë° ì—…ë¡œë“œ
        async function generateHTMLFile(post) {
            const filename = `${post.slug}.html`;

            const htmlContent = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${post.title} - MUMULAB</title>
    <meta name="description" content="${post.summary}">
    <meta name="keywords" content="${post.tags.join(', ')}">
    <link rel="stylesheet" href="../../style.css">
    <style>
        .blog-post {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
            background: #fff;
            color: #333;
        }
        .post-meta {
            color: #666;
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }
        h1, h2, h3 { color: #2563eb; }
        h2 { border-bottom: 2px solid #e5e7eb; padding-bottom: 0.5rem; margin-top: 2rem; }
        ul { margin-left: 1.5rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
    </style>
</head>
<body>
    <div class="blog-post">
        <header>
            <h1>${post.title}</h1>
            <div class="post-meta">
                <span>ğŸ“… ${new Date(post.published || post.created).toLocaleDateString('ko-KR')}</span>
                <span>ğŸ“‚ ${post.category}</span>
                <span>â­ ${post.difficulty}</span>
            </div>
        </header>
        <main>
            ${post.content}
        </main>
        <footer>
            <br><hr><br>
            <p>ğŸ·ï¸ <strong>íƒœê·¸:</strong> ${post.tags.join(', ')}</p>
            <a href="../index.html">â† ë¸”ë¡œê·¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </footer>
    </div>
</body>
</html>`;

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— íŒŒì¼ ì •ë³´ ì €ì¥ (GitHub Actionsê°€ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡)
            const blogFiles = JSON.parse(localStorage.getItem('mumulab_blog_files') || '[]');
            const fileInfo = {
                filename: filename,
                content: htmlContent,
                post: post,
                created: new Date().toISOString()
            };

            blogFiles.push(fileInfo);
            localStorage.setItem('mumulab_blog_files', JSON.stringify(blogFiles));

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ (ë°±ì—…ìš©)
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // GitHubì— íŒŒì¼ ì—…ë¡œë“œ ì‹œë„
            try {
                await uploadToGitHub(filename, htmlContent, post);
            } catch (error) {
                console.log('GitHub ì—…ë¡œë“œ ì‹¤íŒ¨, ìˆ˜ë™ ì—…ë¡œë“œ í•„ìš”:', error);
                showUploadInstructions(filename);
            }
        }

        // GitHubì— íŒŒì¼ ì—…ë¡œë“œ
        async function uploadToGitHub(filename, content, post) {
            // í˜„ì¬ëŠ” GitHub API í† í°ì´ ì—†ìœ¼ë¯€ë¡œ ì‹œë®¬ë ˆì´ì…˜
            // ì‹¤ì œ êµ¬í˜„ ì‹œ GitHub Personal Access Token í•„ìš”
            throw new Error('GitHub API ì—…ë¡œë“œëŠ” ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ë°œí–‰ ì„±ê³µ ì•Œë¦¼
        function showPublishSuccess(filename) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4 text-green-600">ğŸ‰ í¬ìŠ¤íŠ¸ ë°œí–‰ ì™„ë£Œ!</h3>
                    <p class="mb-4">í¬ìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    <div class="bg-blue-50 p-3 rounded mb-4">
                        <p class="text-sm"><strong>ğŸ“ íŒŒì¼:</strong> ${filename}</p>
                        <p class="text-sm"><strong>ğŸ“‹ ìƒíƒœ:</strong> ë¸”ë¡œê·¸ ëª©ë¡ì— ì¶”ê°€ë¨</p>
                    </div>
                    <div class="bg-yellow-50 p-3 rounded mb-4">
                        <p class="text-sm text-yellow-800">
                            <strong>âš ï¸ ì•ˆë‚´:</strong> ë‹¤ìš´ë¡œë“œëœ HTML íŒŒì¼ì„ <code>blog/posts/</code> í´ë”ì— ì—…ë¡œë“œí•˜ë©´ ì‹¤ì œ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">
                            í™•ì¸
                        </button>
                        <button onclick="window.open('../blog/index.html', '_blank')" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                            ë¸”ë¡œê·¸ ë³´ê¸°
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ìˆ˜ë™ ì—…ë¡œë“œ ì•ˆë‚´
        function showUploadInstructions(filename) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4">ğŸ“ íŒŒì¼ ì—…ë¡œë“œ ì•ˆë‚´</h3>
                    <p class="mb-4">ë‹¤ìš´ë¡œë“œëœ HTML íŒŒì¼ì„ ë‹¤ìŒ ê²½ë¡œì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”:</p>
                    <code class="bg-gray-100 p-2 rounded block mb-4">blog/posts/${filename}</code>
                    <p class="text-sm text-gray-600 mb-4">
                        íŒŒì¼ì´ ì—…ë¡œë“œë˜ë©´ ë¸”ë¡œê·¸ì—ì„œ í¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <div class="flex space-x-2">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                            í™•ì¸
                        </button>
                        <button onclick="openFileLocation()" class="flex-1 bg-gray-600 text-white py-2 px-4 rounded hover:bg-gray-700">
                            ë‹¤ìš´ë¡œë“œ í´ë” ì—´ê¸°
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ë‹¤ìš´ë¡œë“œ í´ë” ì—´ê¸° (ë¸Œë¼ìš°ì € ì œí•œìœ¼ë¡œ ì‹¤ì œë¡œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŒ)
        function openFileLocation() {
            alert('ë‹¤ìš´ë¡œë“œ í´ë”ì—ì„œ HTML íŒŒì¼ì„ ì°¾ì•„ blog/posts/ í´ë”ì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
        }

        // ì—ë””í„° ì´ˆê¸°í™”
        function clearEditor() {
            if (confirm('í˜„ì¬ ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì´ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('postTitle').value = '';
                document.getElementById('postCategory').value = 'AIìƒì‚°ì„±';
                document.getElementById('postTags').value = '';
                document.getElementById('postDifficulty').value = 'ì´ˆê¸‰';
                document.getElementById('postSummary').value = '';
                document.getElementById('contentEditor').innerHTML = '';
                currentPostId = null;
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬
        function savePostToStorage(post) {
            const posts = JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
            const existingIndex = posts.findIndex(p => p.id === post.id);

            if (existingIndex >= 0) {
                posts[existingIndex] = post;
            } else {
                posts.push(post);
            }

            localStorage.setItem('mumulab_blog_posts', JSON.stringify(posts));
        }

        function getPost(id) {
            const posts = JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
            return posts.find(p => p.id === id);
        }

        function getAllPosts() {
            return JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
        }

        function deletePost(id) {
            const posts = JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
            const postToDelete = posts.find(p => p.id === id);

            const filtered = posts.filter(p => p.id !== id);
            localStorage.setItem('mumulab_blog_posts', JSON.stringify(filtered));

            // ê¸°ì¡´ íŒŒì¼ì¸ ê²½ìš° ì„œë²„ ì‚­ì œ ì•ˆë‚´ í‘œì‹œ
            if (postToDelete && postToDelete.filename && postToDelete.isImported) {
                showServerDeleteInstructions(postToDelete.filename);
            }
        }

        // í˜„ì¬ í•„í„°ë§ëœ í¬ìŠ¤íŠ¸ë“¤
        let filteredPosts = [];
        let selectedPosts = new Set();

        // ë¸”ë¡œê·¸ ëª©ë¡ í‘œì‹œ
        function refreshBlogList() {
            const posts = getAllPosts().sort((a, b) => new Date(b.updated) - new Date(a.updated));
            filteredPosts = posts;
            selectedPosts.clear();

            updateStatistics(posts);
            renderPostList(posts);
            updateBulkDeleteButton();
        }

        // ê¸°ì¡´ ë¸”ë¡œê·¸ íŒŒì¼ë“¤ì„ localStorageì— ê°€ì ¸ì˜¤ê¸°
        async function importExistingBlogFiles() {
            if (!confirm('ê¸°ì¡´ blog/posts/ í´ë”ì˜ íŒŒì¼ë“¤ì„ ê´€ë¦¬ì ì‹œìŠ¤í…œì— ê°€ì ¸ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }

            // ì•Œë ¤ì§„ ê¸°ì¡´ íŒŒì¼ë“¤ ëª©ë¡
            const existingFiles = [
                '2025-09-23-test1234.html',
                'ai-coding-assistant-comparison.html',
                'ai-content-creator-ecosystem.html',
                'ai-data-analysis-tools.html',
                'ai-ethics-business-practice.html',
                'ai-learning-plan-2024.html',
                'ai-tool-stack-optimization.html',
                'ai-translation-automation.html',
                'creative-ai-problem-solving.html',
                'efficient-work-management.html'
            ];

            let importedCount = 0;
            const existingPosts = getAllPosts();

            for (const filename of existingFiles) {
                try {
                    // íŒŒì¼ ë‚´ìš©ì„ ê°€ì ¸ì˜¤ëŠ” ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œë¡œëŠ” ì„œë²„ API í•„ìš”)
                    const response = await fetch(`../blog/posts/${filename}`);
                    if (response.ok) {
                        const content = await response.text();

                        // HTML íŒŒì‹±í•˜ì—¬ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(content, 'text/html');

                        const title = doc.querySelector('title')?.textContent?.replace(' - MUMULAB', '') || filename.replace('.html', '');
                        const metaDesc = doc.querySelector('meta[name="description"]')?.content || '';

                        // ì´ë¯¸ ìˆëŠ”ì§€ í™•ì¸
                        const exists = existingPosts.some(post => post.filename === filename);
                        if (!exists) {
                            const post = {
                                id: 'imported_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                                title: title,
                                category: 'AIìƒì‚°ì„±',
                                tags: 'AI, ìƒì‚°ì„±',
                                difficulty: 'ì¤‘ê¸‰',
                                summary: metaDesc,
                                content: doc.querySelector('main')?.innerHTML || content,
                                created: new Date().toISOString(),
                                updated: new Date().toISOString(),
                                status: 'published',
                                filename: filename,
                                isImported: true
                            };

                            existingPosts.push(post);
                            importedCount++;
                        }
                    }
                } catch (error) {
                    console.log(`íŒŒì¼ ${filename} ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:`, error);
                }
            }

            // localStorageì— ì €ì¥
            localStorage.setItem('mumulab_blog_posts', JSON.stringify(existingPosts));

            if (importedCount > 0) {
                alert(`${importedCount}ê°œì˜ ê¸°ì¡´ ë¸”ë¡œê·¸ íŒŒì¼ì„ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤!`);
                refreshBlogList();
            } else {
                alert('ìƒˆë¡œ ê°€ì ¸ì˜¬ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // íŒŒì¼ ì„œë²„ì—ì„œ ì‹¤ì œ ì‚­ì œ ì•ˆë‚´
        function showServerDeleteInstructions(filename) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4 text-red-600">ğŸ—‘ï¸ ì„œë²„ íŒŒì¼ ì‚­ì œ ì•ˆë‚´</h3>
                    <p class="mb-4">ë‹¤ìŒ íŒŒì¼ì„ ì„œë²„ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì‚­ì œí•´ì£¼ì„¸ìš”:</p>
                    <code class="bg-red-50 p-2 rounded block mb-4 text-red-800 text-sm">blog/posts/${filename}</code>
                    <p class="text-sm text-gray-600 mb-4">
                        ê´€ë¦¬ì ì‹œìŠ¤í…œì—ì„œëŠ” ëª©ë¡ì—ì„œ ì œê±°ë˜ì—ˆì§€ë§Œ, ì‹¤ì œ ì„œë²„ íŒŒì¼ì€ ìˆ˜ë™ìœ¼ë¡œ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤.
                    </p>
                    <div class="flex space-x-2">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700">
                            í™•ì¸
                        </button>
                        <button onclick="copyToClipboard('blog/posts/${filename}'); this.closest('.fixed').remove();" class="flex-1 bg-gray-600 text-white py-2 px-4 rounded hover:bg-gray-700">
                            ê²½ë¡œ ë³µì‚¬
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // í´ë¦½ë³´ë“œì— ë³µì‚¬
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('ê²½ë¡œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }).catch(() => {
                // í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨ ì‹œ í…ìŠ¤íŠ¸ ì„ íƒ
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('ê²½ë¡œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ê¸€ ì¶”ê°€ (ê°œë°œ ì‹œì—ë§Œ ì‚¬ìš©)
        function addSamplePost() {
            if (!confirm('í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ê¸€ì„ ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const samplePost = {
                id: 'sample_' + Date.now(),
                title: 'í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ê¸€ - AI ìƒì‚°ì„± í–¥ìƒí•˜ê¸°',
                category: 'AIìƒì‚°ì„±',
                tags: 'AI, ìƒì‚°ì„±, í…ŒìŠ¤íŠ¸',
                difficulty: 'ì¤‘ê¸‰',
                summary: 'ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ë¸”ë¡œê·¸ ê¸€ì…ë‹ˆë‹¤. ê´€ë¦¬ì ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.',
                content: '<h2>ìƒ˜í”Œ ê¸€ ë‚´ìš©</h2><p>ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ê¸€ì…ë‹ˆë‹¤.</p><ul><li>ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ìš©</li><li>ì‹œìŠ¤í…œ í™•ì¸ìš©</li><li>ë°ëª¨ìš©</li></ul>',
                created: new Date().toISOString(),
                updated: new Date().toISOString(),
                status: 'draft'
            };

            const posts = getAllPosts();
            posts.push(samplePost);
            localStorage.setItem('mumulab_blog_posts', JSON.stringify(posts));

            alert('ìƒ˜í”Œ ê¸€ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
            refreshBlogList();
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStatistics(posts) {
            const totalCount = posts.length;
            const publishedCount = posts.filter(p => p.status === 'published').length;
            const draftCount = posts.filter(p => p.status === 'draft').length;

            document.getElementById('totalCount').textContent = totalCount;
            document.getElementById('publishedCount').textContent = publishedCount;
            document.getElementById('draftCount').textContent = draftCount;
        }

        // í¬ìŠ¤íŠ¸ ëª©ë¡ ë Œë”ë§
        function renderPostList(posts) {
            const container = document.getElementById('blogListContainer');

            if (posts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">ì¡°ê±´ì— ë§ëŠ” ë¸”ë¡œê·¸ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            container.innerHTML = posts.map(post => `
                <div class="border border-gray-200 rounded-lg p-4 mb-4 hover:shadow-md transition-shadow ${selectedPosts.has(post.id) ? 'ring-2 ring-blue-500 bg-blue-50' : ''}">
                    <div class="flex items-start gap-3">
                        <!-- ì„ íƒ ì²´í¬ë°•ìŠ¤ -->
                        <input type="checkbox"
                               class="mt-1 post-checkbox"
                               data-post-id="${post.id}"
                               ${selectedPosts.has(post.id) ? 'checked' : ''}
                               onchange="togglePostSelection('${post.id}')">

                        <!-- í¬ìŠ¤íŠ¸ ë‚´ìš© -->
                        <div class="flex-1">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="text-lg font-semibold text-gray-800 cursor-pointer hover:text-blue-600" onclick="editPost('${post.id}')">
                                    ${post.title}
                                </h3>
                                <span class="px-2 py-1 text-xs rounded ${post.status === 'published' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}">
                                    ${post.status === 'published' ? 'ë°œí–‰ë¨' : 'ì„ì‹œì €ì¥'}
                                </span>
                            </div>

                            <div class="text-sm text-gray-600 mb-2">
                                <span>ğŸ“‚ ${post.category}</span> |
                                <span>â­ ${post.difficulty}</span> |
                                <span>ğŸ“… ${new Date(post.updated).toLocaleDateString('ko-KR')}</span>
                                ${post.isImported ? '| ğŸ“ ê¸°ì¡´íŒŒì¼' : ''}
                                ${post.tags && post.tags.length > 0 ? `| ğŸ·ï¸ ${post.tags.join(', ')}` : ''}
                            </div>

                            <p class="text-gray-700 text-sm mb-3 line-clamp-2">${post.summary || 'ìš”ì•½ì´ ì—†ìŠµë‹ˆë‹¤.'}</p>

                            <div class="flex gap-2 flex-wrap">
                                <button onclick="editPost('${post.id}')" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition-colors">
                                    âœï¸ í¸ì§‘
                                </button>
                                <button onclick="duplicatePost('${post.id}')" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors">
                                    ğŸ“‹ ë³µì‚¬
                                </button>
                                ${post.status === 'published' ?
                                    `<button onclick="republishPost('${post.id}')" class="bg-purple-500 text-white px-3 py-1 rounded text-sm hover:bg-purple-600 transition-colors">
                                        ğŸ”„ ì¬ë°œí–‰
                                    </button>` :
                                    `<button onclick="publishPostFromList('${post.id}')" class="bg-indigo-500 text-white px-3 py-1 rounded text-sm hover:bg-indigo-600 transition-colors">
                                        ğŸš€ ë°œí–‰
                                    </button>`
                                }
                                <button onclick="viewPostDetails('${post.id}')" class="bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors">
                                    ğŸ‘ï¸ ë³´ê¸°
                                </button>
                                <button onclick="deletePostConfirm('${post.id}')" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors">
                                    ğŸ—‘ï¸ ì‚­ì œ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // í¬ìŠ¤íŠ¸ í¸ì§‘
        function editPost(id) {
            const post = getPost(id);
            if (post) {
                document.getElementById('postTitle').value = post.title;
                document.getElementById('postCategory').value = post.category;
                document.getElementById('postTags').value = post.tags.join(', ');
                document.getElementById('postDifficulty').value = post.difficulty;
                document.getElementById('postSummary').value = post.summary;
                document.getElementById('contentEditor').innerHTML = post.content;

                currentPostId = id;
                switchTab('edit');
            }
        }

        // í¬ìŠ¤íŠ¸ ë³µì‚¬
        function duplicatePost(id) {
            const post = getPost(id);
            if (post) {
                const newPost = {
                    ...post,
                    id: Date.now().toString(),
                    title: post.title + ' (ë³µì‚¬ë³¸)',
                    created: new Date().toISOString(),
                    updated: new Date().toISOString(),
                    status: 'draft'
                };
                delete newPost.published;

                savePostToStorage(newPost);
                refreshBlogList();
                alert('í¬ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í¬ìŠ¤íŠ¸ ì‚­ì œ í™•ì¸
        function deletePostConfirm(id) {
            const post = getPost(id);
            if (post && confirm(`"${post.title}" ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                deletePost(id);
                refreshBlogList();

                if (currentPostId === id) {
                    clearEditor();
                }
            }
        }

        // ê²€ìƒ‰ ë° í•„í„°ë§
        function filterPosts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;

            const allPosts = getAllPosts();
            const filtered = allPosts.filter(post => {
                const matchesSearch = post.title.toLowerCase().includes(searchTerm) ||
                                    (post.summary && post.summary.toLowerCase().includes(searchTerm));
                const matchesCategory = !categoryFilter || post.category === categoryFilter;
                const matchesStatus = !statusFilter || post.status === statusFilter;

                return matchesSearch && matchesCategory && matchesStatus;
            });

            filteredPosts = filtered.sort((a, b) => new Date(b.updated) - new Date(a.updated));
            renderPostList(filteredPosts);
            updateStatistics(filtered);
            selectedPosts.clear();
            updateBulkDeleteButton();
        }

        // í¬ìŠ¤íŠ¸ ì„ íƒ í† ê¸€
        function togglePostSelection(id) {
            if (selectedPosts.has(id)) {
                selectedPosts.delete(id);
            } else {
                selectedPosts.add(id);
            }
            updateBulkDeleteButton();
            renderPostList(filteredPosts); // ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë‹¤ì‹œ ë Œë”ë§
        }

        // ì „ì²´ ì„ íƒ í† ê¸€
        function toggleSelectAll() {
            const allSelected = filteredPosts.every(post => selectedPosts.has(post.id));

            if (allSelected) {
                // ëª¨ë‘ ì„ íƒí•´ì œ
                selectedPosts.clear();
            } else {
                // ëª¨ë‘ ì„ íƒ
                filteredPosts.forEach(post => selectedPosts.add(post.id));
            }

            updateBulkDeleteButton();
            renderPostList(filteredPosts);
        }

        // ì„ íƒì‚­ì œ ë²„íŠ¼ ì—…ë°ì´íŠ¸
        function updateBulkDeleteButton() {
            const bulkDeleteBtn = document.getElementById('bulkDeleteBtn');
            const selectAllBtn = document.getElementById('selectAllBtn');

            if (selectedPosts.size > 0) {
                bulkDeleteBtn.classList.remove('hidden');
                bulkDeleteBtn.textContent = `ğŸ—‘ï¸ ì„ íƒì‚­ì œ (${selectedPosts.size})`;
            } else {
                bulkDeleteBtn.classList.add('hidden');
            }

            // ì „ì²´ì„ íƒ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            const allSelected = filteredPosts.length > 0 && filteredPosts.every(post => selectedPosts.has(post.id));
            selectAllBtn.textContent = allSelected ? 'â˜‘ï¸ ì „ì²´í•´ì œ' : 'â˜‘ï¸ ì „ì²´ì„ íƒ';
        }

        // ì¼ê´„ ì‚­ì œ
        function bulkDelete() {
            if (selectedPosts.size === 0) return;

            const deleteCount = selectedPosts.size;
            const message = `ì„ íƒí•œ ${deleteCount}ê°œì˜ ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì‚­ì œëœ ê¸€ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;
            if (confirm(message)) {
                selectedPosts.forEach(id => {
                    deletePost(id);
                    if (currentPostId === id) {
                        clearEditor();
                    }
                });

                selectedPosts.clear();
                refreshBlogList();
                alert(`${deleteCount}ê°œì˜ ê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }

        // ëª©ë¡ì—ì„œ ì§ì ‘ ë°œí–‰
        async function publishPostFromList(id) {
            const post = getPost(id);
            if (post) {
                post.status = 'published';
                post.published = new Date().toISOString();
                post.slug = generateSlug(post.title, post.published);
                savePostToStorage(post);

                try {
                    await generateHTMLFile(post);
                    showPublishSuccess(post.slug + '.html');
                } catch (error) {
                    console.error('ë°œí–‰ ì¤‘ ì˜¤ë¥˜:', error);
                    alert('ë°œí–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }

                refreshBlogList();
            }
        }

        // ì¬ë°œí–‰
        async function republishPost(id) {
            if (confirm('ì´ ê¸€ì„ ë‹¤ì‹œ ë°œí–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ìƒˆë¡œìš´ HTML íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.')) {
                await publishPostFromList(id);
            }
        }

        // í¬ìŠ¤íŠ¸ ìƒì„¸ ë³´ê¸°
        function viewPostDetails(id) {
            const post = getPost(id);
            if (!post) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto">
                    <div class="sticky top-0 bg-white border-b p-4 flex justify-between items-center">
                        <h3 class="text-xl font-bold">ğŸ“ ${post.title}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700 text-2xl">
                            Ã—
                        </button>
                    </div>

                    <div class="p-6">
                        <!-- ë©”íƒ€ ì •ë³´ -->
                        <div class="bg-gray-50 p-4 rounded-lg mb-6">
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                                <div>
                                    <span class="font-semibold">ğŸ“‚ ì¹´í…Œê³ ë¦¬:</span><br>
                                    ${post.category}
                                </div>
                                <div>
                                    <span class="font-semibold">â­ ë‚œì´ë„:</span><br>
                                    ${post.difficulty}
                                </div>
                                <div>
                                    <span class="font-semibold">ğŸ“‹ ìƒíƒœ:</span><br>
                                    <span class="px-2 py-1 text-xs rounded ${post.status === 'published' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}">
                                        ${post.status === 'published' ? 'ë°œí–‰ë¨' : 'ì„ì‹œì €ì¥'}
                                    </span>
                                </div>
                                <div>
                                    <span class="font-semibold">ğŸ“… ìˆ˜ì •ì¼:</span><br>
                                    ${new Date(post.updated).toLocaleString('ko-KR')}
                                </div>
                            </div>

                            ${post.tags && post.tags.length > 0 ? `
                                <div class="mt-3">
                                    <span class="font-semibold">ğŸ·ï¸ íƒœê·¸:</span>
                                    <div class="mt-1">
                                        ${post.tags.map(tag => `<span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1">${tag}</span>`).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            ${post.summary ? `
                                <div class="mt-3">
                                    <span class="font-semibold">ğŸ“„ ìš”ì•½:</span>
                                    <p class="mt-1 text-gray-700">${post.summary}</p>
                                </div>
                            ` : ''}
                        </div>

                        <!-- ë‚´ìš© ë¯¸ë¦¬ë³´ê¸° -->
                        <div class="prose max-w-none">
                            <h4 class="text-lg font-semibold mb-3">ğŸ“– ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°</h4>
                            <div class="border rounded-lg p-4 bg-gray-50 max-h-96 overflow-auto">
                                ${post.content || '<p class="text-gray-500">ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.</p>'}
                            </div>
                        </div>

                        <!-- ì•¡ì…˜ ë²„íŠ¼ -->
                        <div class="mt-6 flex gap-3 justify-end">
                            <button onclick="editPost('${post.id}'); this.closest('.fixed').remove();" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                                âœï¸ í¸ì§‘
                            </button>
                            <button onclick="duplicatePost('${post.id}'); this.closest('.fixed').remove();" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                                ğŸ“‹ ë³µì‚¬
                            </button>
                            <button onclick="this.closest('.fixed').remove()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                                ë‹«ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ê¸€ ëª©ë¡ í‘œì‹œ (íƒ­ì—ì„œ í˜¸ì¶œ)
        function showBlogList() {
            switchTab('list');
        }
    </script>
</body>
</html>