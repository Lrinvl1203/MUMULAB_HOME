<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”’ Blog Admin Editor - MUMULAB</title>
    <meta name="robots" content="noindex, nofollow">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ë¦¬ì¹˜ í…ìŠ¤íŠ¸ ì—ë””í„° ìŠ¤íƒ€ì¼ */
        .editor-toolbar {
            border-bottom: 1px solid #e5e7eb;
            padding: 0.5rem;
            background: #f9fafb;
            border-radius: 0.5rem 0.5rem 0 0;
        }

        .editor-content {
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 0.5rem 0.5rem;
            background: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
        }

        .editor-content:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* í”„ë¦¬ë·° ìŠ¤íƒ€ì¼ */
        .preview-content {
            background: white;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            line-height: 1.6;
        }

        .preview-content h1, .preview-content h2, .preview-content h3 {
            color: #2563eb;
            margin-bottom: 1rem;
            margin-top: 1.5rem;
        }

        .preview-content h1 { font-size: 2rem; font-weight: bold; }
        .preview-content h2 { font-size: 1.5rem; font-weight: bold; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.5rem; }
        .preview-content h3 { font-size: 1.25rem; font-weight: bold; }

        .preview-content p { margin-bottom: 1rem; }
        .preview-content ul, .preview-content ol { margin: 1rem 0 1rem 1.5rem; }
        .preview-content li { margin-bottom: 0.5rem; }

        /* ì¸ì¦ ëª¨ë‹¬ */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .auth-modal.hidden {
            display: none;
        }

        /* í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ í‘œì‹œ */
        .shortcut-hint {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .shortcut-hint.show {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- ì¸ì¦ ëª¨ë‹¬ -->
    <div id="authModal" class="auth-modal">
        <div class="bg-white p-8 rounded-lg shadow-2xl max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">ğŸ” ê´€ë¦¬ì ì¸ì¦</h2>
                <p class="text-gray-600">ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì—¬ ê´€ë¦¬ì ëª¨ë“œì— ì ‘ê·¼í•˜ì„¸ìš”</p>
                <div class="text-sm text-gray-500 mt-2">
                    ë‹¨ì¶•í‚¤: <kbd class="bg-gray-200 px-2 py-1 rounded">Ctrl + Alt + A</kbd>
                </div>
            </div>

            <form id="authForm">
                <div class="mb-4">
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                        ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸
                    </label>
                    <input
                        type="password"
                        id="password"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                        autocomplete="off"
                    >
                </div>

                <div class="flex gap-3">
                    <button
                        type="submit"
                        class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors"
                    >
                        ë¡œê·¸ì¸
                    </button>
                    <button
                        type="button"
                        onclick="closeAuthModal()"
                        class="flex-1 bg-gray-400 text-white py-2 px-4 rounded-md hover:bg-gray-500 transition-colors"
                    >
                        ì·¨ì†Œ
                    </button>
                </div>

                <div id="authError" class="text-red-600 text-sm mt-3 hidden">
                    ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </div>
            </form>
        </div>
    </div>

    <!-- í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ íŒíŠ¸ -->
    <div id="shortcutHint" class="shortcut-hint">
        Ctrl + Alt + A: ê´€ë¦¬ì ëª¨ë“œ
    </div>

    <!-- ë©”ì¸ ì—ë””í„° -->
    <div id="adminEditor" class="hidden">
        <div class="container mx-auto px-4 py-8">
            <!-- í—¤ë” -->
            <header class="mb-8">
                <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4">
                    <strong>ğŸ”’ ê´€ë¦¬ì ì „ìš© ë¸”ë¡œê·¸ ì—ë””í„°</strong> - ì´ í˜ì´ì§€ëŠ” ì¸ì¦ëœ ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                </div>

                <div class="flex justify-between items-center">
                    <h1 class="text-3xl font-bold text-gray-800">ğŸ“ ë¸”ë¡œê·¸ ê´€ë¦¬ì ì—ë””í„°</h1>
                    <div class="flex gap-2">
                        <button onclick="showBlogList()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition-colors">
                            ğŸ“‹ ê¸€ ëª©ë¡
                        </button>
                        <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors">
                            ğŸšª ë¡œê·¸ì•„ì›ƒ
                        </button>
                    </div>
                </div>
            </header>

            <!-- íƒ­ ë©”ë‰´ -->
            <div class="mb-6">
                <div class="border-b border-gray-200">
                    <nav class="-mb-px flex space-x-8">
                        <button
                            id="editTab"
                            onclick="switchTab('edit')"
                            class="py-2 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600"
                        >
                            âœï¸ í¸ì§‘
                        </button>
                        <button
                            id="previewTab"
                            onclick="switchTab('preview')"
                            class="py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700"
                        >
                            ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°
                        </button>
                        <button
                            id="listTab"
                            onclick="switchTab('list')"
                            class="py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700"
                        >
                            ğŸ“‹ ê¸€ ëª©ë¡
                        </button>
                    </nav>
                </div>
            </div>

            <!-- í¸ì§‘ íŒ¨ë„ -->
            <div id="editPanel" class="grid lg:grid-cols-2 gap-6">
                <!-- ë©”íƒ€ë°ì´í„° ì…ë ¥ -->
                <div class="space-y-4">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold mb-4">ğŸ“Š í¬ìŠ¤íŠ¸ ì •ë³´</h3>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ì œëª©</label>
                                <input
                                    type="text"
                                    id="postTitle"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                                >
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</label>
                                <select id="postCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="AIìƒì‚°ì„±">AI ìƒì‚°ì„±</option>
                                    <option value="ì‹œê°„ê´€ë¦¬">ì‹œê°„ê´€ë¦¬</option>
                                    <option value="ëª¨ë°”ì¼AI">ëª¨ë°”ì¼ AI</option>
                                    <option value="ìŒì„±AI">ìŒì„± AI</option>
                                    <option value="ì»¤ë®¤ë‹ˆì¼€ì´ì…˜">ì»¤ë®¤ë‹ˆì¼€ì´ì…˜</option>
                                    <option value="ì •ë³´ì²˜ë¦¬">ì •ë³´ì²˜ë¦¬</option>
                                    <option value="ê°œì¸í™”AI">ê°œì¸í™” AI</option>
                                    <option value="ì–¸ì–´AI">ì–¸ì–´ AI</option>
                                    <option value="ì°½ì‘AI">ì°½ì‘ AI</option>
                                    <option value="ë°ì´í„°ë¶„ì„">ë°ì´í„°ë¶„ì„</option>
                                    <option value="ìë™í™”">ìë™í™”</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">íƒœê·¸ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                                <input
                                    type="text"
                                    id="postTags"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="AI, ìƒì‚°ì„±, ìë™í™”"
                                >
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ë‚œì´ë„</label>
                                <select id="postDifficulty" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="ì´ˆê¸‰">ì´ˆê¸‰</option>
                                    <option value="ì¤‘ê¸‰">ì¤‘ê¸‰</option>
                                    <option value="ê³ ê¸‰">ê³ ê¸‰</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ìš”ì•½</label>
                                <textarea
                                    id="postSummary"
                                    rows="3"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="í¬ìŠ¤íŠ¸ ìš”ì•½ì„ ì‘ì„±í•˜ì„¸ìš” (SEO ë©”íƒ€ ì„¤ëª…ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤)"
                                ></textarea>
                            </div>
                        </div>

                        <div class="mt-6 flex gap-3">
                            <button onclick="savePost()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors">
                                ğŸ’¾ ì €ì¥
                            </button>
                            <button onclick="publishPost()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                                ğŸš€ ë°œí–‰
                            </button>
                            <button onclick="clearEditor()" class="bg-gray-400 text-white py-2 px-4 rounded-md hover:bg-gray-500 transition-colors">
                                ğŸ—‘ï¸ ì´ˆê¸°í™”
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ì—ë””í„° -->
                <div class="space-y-4">
                    <div class="bg-white rounded-lg shadow">
                        <!-- íˆ´ë°” -->
                        <div class="editor-toolbar">
                            <div class="flex flex-wrap gap-2">
                                <button onclick="formatText('bold')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    <strong>B</strong>
                                </button>
                                <button onclick="formatText('italic')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    <em>I</em>
                                </button>
                                <button onclick="formatText('insertUnorderedList')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    â€¢ ëª©ë¡
                                </button>
                                <button onclick="formatText('insertOrderedList')" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    1. ë²ˆí˜¸
                                </button>
                                <button onclick="insertHeading(2)" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    H2
                                </button>
                                <button onclick="insertHeading(3)" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm">
                                    H3
                                </button>
                                <button onclick="insertTemplate()" class="px-3 py-1 bg-blue-200 hover:bg-blue-300 rounded text-sm">
                                    ğŸ“‹ í…œí”Œë¦¿
                                </button>
                            </div>
                        </div>

                        <!-- ì—ë””í„° -->
                        <div
                            id="contentEditor"
                            class="editor-content"
                            contenteditable="true"
                            data-placeholder="ì—¬ê¸°ì— ë¸”ë¡œê·¸ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”..."
                        ></div>
                    </div>
                </div>
            </div>

            <!-- ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ -->
            <div id="previewPanel" class="hidden">
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="preview-content" id="previewContent">
                        <h1>ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”</h1>
                        <div class="text-gray-600 mb-4 border-b pb-4">
                            <span>ğŸ“… 2024-09-23</span> |
                            <span>ğŸ“‚ ì¹´í…Œê³ ë¦¬</span> |
                            <span>â­ ë‚œì´ë„</span>
                        </div>
                        <p>ë‚´ìš©ì„ ì‘ì„±í•˜ë©´ ì—¬ê¸°ì— ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>

            <!-- ê¸€ ëª©ë¡ íŒ¨ë„ -->
            <div id="listPanel" class="hidden">
                <div class="bg-white rounded-lg shadow">
                    <div class="p-6 border-b">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-semibold">ğŸ“‹ ì €ì¥ëœ ë¸”ë¡œê·¸ ê¸€</h3>
                            <button onclick="refreshBlogList()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors">
                                ğŸ”„ ìƒˆë¡œê³ ì¹¨
                            </button>
                        </div>
                    </div>
                    <div id="blogListContainer" class="p-6">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ê´€ë¦¬ì ì¸ì¦ ì„¤ì •
        const ADMIN_PASSWORD = 'mumulab2024!'; // ì‹¤ì œ ìš´ì˜ì‹œì—ëŠ” ë” ë³µì¡í•œ ì¸ì¦ ì‹œìŠ¤í…œ ì‚¬ìš©
        const AUTH_STORAGE_KEY = 'mumulab_admin_auth';

        // í˜„ì¬ í¸ì§‘ ì¤‘ì¸ í¬ìŠ¤íŠ¸ ID
        let currentPostId = null;

        // ê¸°ì¡´ í¬ìŠ¤íŠ¸ slug ë§ˆì´ê·¸ë ˆì´ì…˜
        function migratePostSlugs() {
            const posts = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            let migrated = false;

            posts.forEach(post => {
                // slugê°€ ì—†ê±°ë‚˜ admin- í˜•íƒœì¸ ê²½ìš° ìƒˆë¡œ ìƒì„±
                if (!post.slug || post.slug.startsWith('admin-')) {
                    const date = post.published || post.created;
                    post.slug = generateSlug(post.title, date);
                    migrated = true;
                }
            });

            if (migrated) {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(posts));
                console.log('í¬ìŠ¤íŠ¸ slug ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ');
            }
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            // í¬ìŠ¤íŠ¸ slug ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
            migratePostSlugs();

            // ì¸ì¦ í™•ì¸
            if (isAuthenticated()) {
                showAdminEditor();
            } else {
                showAuthModal();
            }

            // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì„¤ì •
            setupKeyboardShortcuts();

            // ì—ë””í„° ì´ë²¤íŠ¸ ì„¤ì •
            setupEditor();

            // íŒíŠ¸ í‘œì‹œ
            showShortcutHint();
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì„¤ì •
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ctrl + Alt + A: ê´€ë¦¬ì ëª¨ë“œ í† ê¸€
                if (e.ctrlKey && e.altKey && e.key === 'A') {
                    e.preventDefault();
                    if (isAuthenticated()) {
                        logout();
                    } else {
                        showAuthModal();
                    }
                }

                // ESC: ëª¨ë‹¬ ë‹«ê¸°
                if (e.key === 'Escape') {
                    closeAuthModal();
                }
            });
        }

        // ë‹¨ì¶•í‚¤ íŒíŠ¸ í‘œì‹œ
        function showShortcutHint() {
            const hint = document.getElementById('shortcutHint');
            hint.classList.add('show');

            setTimeout(() => {
                hint.classList.remove('show');
            }, 3000);
        }

        // ì¸ì¦ ìƒíƒœ í™•ì¸
        function isAuthenticated() {
            const auth = sessionStorage.getItem(AUTH_STORAGE_KEY);
            return auth === 'authenticated';
        }

        // ì¸ì¦ ëª¨ë‹¬ í‘œì‹œ
        function showAuthModal() {
            document.getElementById('authModal').classList.remove('hidden');
            document.getElementById('password').focus();
        }

        // ì¸ì¦ ëª¨ë‹¬ ë‹«ê¸°
        function closeAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('authError').classList.add('hidden');
            document.getElementById('password').value = '';
        }

        // ê´€ë¦¬ì ì—ë””í„° í‘œì‹œ
        function showAdminEditor() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('adminEditor').classList.remove('hidden');
            refreshBlogList();
        }

        // ì¸ì¦ ì²˜ë¦¬
        document.getElementById('authForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const password = document.getElementById('password').value;

            if (password === ADMIN_PASSWORD) {
                sessionStorage.setItem(AUTH_STORAGE_KEY, 'authenticated');
                showAdminEditor();
                closeAuthModal();
            } else {
                document.getElementById('authError').classList.remove('hidden');
                document.getElementById('password').value = '';
                document.getElementById('password').focus();
            }
        });

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            sessionStorage.removeItem(AUTH_STORAGE_KEY);
            document.getElementById('adminEditor').classList.add('hidden');
            showAuthModal();
        }

        // íƒ­ ì „í™˜
        function switchTab(tab) {
            // íƒ­ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('[id$="Tab"]').forEach(btn => {
                btn.className = btn.className.replace('border-blue-500 text-blue-600', 'border-transparent text-gray-500 hover:text-gray-700');
            });

            document.getElementById(tab + 'Tab').className = document.getElementById(tab + 'Tab').className.replace('border-transparent text-gray-500 hover:text-gray-700', 'border-blue-500 text-blue-600');

            // íŒ¨ë„ í‘œì‹œ/ìˆ¨ê¹€
            document.getElementById('editPanel').classList.toggle('hidden', tab !== 'edit');
            document.getElementById('previewPanel').classList.toggle('hidden', tab !== 'preview');
            document.getElementById('listPanel').classList.toggle('hidden', tab !== 'list');

            // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
            if (tab === 'preview') {
                updatePreview();
            }

            // ê¸€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            if (tab === 'list') {
                refreshBlogList();
            }
        }

        // ì—ë””í„° ì„¤ì •
        function setupEditor() {
            const editor = document.getElementById('contentEditor');

            // í”Œë ˆì´ìŠ¤í™€ë” ì²˜ë¦¬
            editor.addEventListener('focus', () => {
                if (editor.textContent.trim() === '') {
                    editor.innerHTML = '';
                }
            });

            editor.addEventListener('blur', () => {
                if (editor.textContent.trim() === '') {
                    editor.innerHTML = '';
                }
            });

            // ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
            editor.addEventListener('input', () => {
                if (document.getElementById('previewPanel').classList.contains('hidden') === false) {
                    updatePreview();
                }
            });
        }

        // í…ìŠ¤íŠ¸ í¬ë§·íŒ…
        function formatText(command) {
            document.execCommand(command, false, null);
            document.getElementById('contentEditor').focus();
        }

        // í—¤ë”© ì‚½ì…
        function insertHeading(level) {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                const heading = document.createElement('h' + level);
                heading.textContent = selection.toString() || 'ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”';

                range.deleteContents();
                range.insertNode(heading);

                // ì»¤ì„œë¥¼ í—¤ë”© ëìœ¼ë¡œ ì´ë™
                range.setStartAfter(heading);
                range.setEndAfter(heading);
                selection.removeAllRanges();
                selection.addRange(range);
            }
            document.getElementById('contentEditor').focus();
        }

        // í…œí”Œë¦¿ ì‚½ì…
        function insertTemplate() {
            const template = `<h2>ê°œìš”</h2>
<p>ì´ ê¸€ì—ì„œëŠ” [ì£¼ì œ]ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h2>ì£¼ìš” ê¸°ëŠ¥</h2>
<ul>
<li><strong>ê¸°ëŠ¥ 1</strong>: ì„¤ëª…</li>
<li><strong>ê¸°ëŠ¥ 2</strong>: ì„¤ëª…</li>
<li><strong>ê¸°ëŠ¥ 3</strong>: ì„¤ëª…</li>
</ul>

<h2>ì‹¤í–‰ ë‹¨ê³„</h2>

<h3>1ë‹¨ê³„: ì¤€ë¹„í•˜ê¸°</h3>
<p>ì²« ë²ˆì§¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…</p>

<h3>2ë‹¨ê³„: ì‹¤í–‰í•˜ê¸°</h3>
<p>ë‘ ë²ˆì§¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…</p>

<h3>3ë‹¨ê³„: ìµœì í™”</h3>
<p>ì„¸ ë²ˆì§¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…</p>

<h2>ì£¼ì˜ì‚¬í•­</h2>
<ul>
<li>âš ï¸ ì£¼ì˜í•´ì•¼ í•  ì </li>
<li>ğŸ’¡ ìœ ìš©í•œ íŒ</li>
<li>ğŸ”§ ë¬¸ì œ í•´ê²° ë°©ë²•</li>
</ul>

<h2>ë§ˆë¬´ë¦¬</h2>
<p>ì´ ê¸€ì—ì„œ ì†Œê°œí•œ ë°©ë²•ì„ í†µí•´ [ëª©í‘œ]ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>`;

            document.getElementById('contentEditor').innerHTML = template;
        }

        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updatePreview() {
            const title = document.getElementById('postTitle').value || 'ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”';
            const category = document.getElementById('postCategory').value;
            const difficulty = document.getElementById('postDifficulty').value;
            const content = document.getElementById('contentEditor').innerHTML;

            const previewContent = document.getElementById('previewContent');
            const today = new Date().toLocaleDateString('ko-KR');

            previewContent.innerHTML = `
                <h1>${title}</h1>
                <div class="text-gray-600 mb-4 border-b pb-4">
                    <span>ğŸ“… ${today}</span> |
                    <span>ğŸ“‚ ${category}</span> |
                    <span>â­ ${difficulty}</span>
                </div>
                ${content || '<p>ë‚´ìš©ì„ ì‘ì„±í•˜ë©´ ì—¬ê¸°ì— ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>'}
            `;
        }

        // íŒŒì¼ëª… ìƒì„± í•¨ìˆ˜
        function generateSlug(title, date) {
            const formattedDate = new Date(date).toISOString().split('T')[0];
            const cleanTitle = title.replace(/[^a-zA-Z0-9ê°€-í£\s]/g, '').replace(/\s+/g, '-');
            return `${formattedDate}-${cleanTitle}`;
        }

        // í¬ìŠ¤íŠ¸ ì €ì¥
        function savePost() {
            const title = document.getElementById('postTitle').value;
            const postData = {
                id: currentPostId || Date.now().toString(),
                title: title,
                category: document.getElementById('postCategory').value,
                tags: document.getElementById('postTags').value.split(',').map(tag => tag.trim()),
                difficulty: document.getElementById('postDifficulty').value,
                summary: document.getElementById('postSummary').value,
                content: document.getElementById('contentEditor').innerHTML,
                created: currentPostId ? getPost(currentPostId)?.created || new Date().toISOString() : new Date().toISOString(),
                updated: new Date().toISOString(),
                status: 'draft'
            };

            // slug ìƒì„± (íŒŒì¼ëª…ê³¼ ì¼ì¹˜í•˜ë„ë¡)
            postData.slug = generateSlug(title, postData.created);

            if (!postData.title.trim()) {
                alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            savePostToStorage(postData);
            currentPostId = postData.id;

            alert('í¬ìŠ¤íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            refreshBlogList();
        }

        // í¬ìŠ¤íŠ¸ ë°œí–‰
        async function publishPost() {
            savePost(); // ë¨¼ì € ì €ì¥

            if (currentPostId) {
                const post = getPost(currentPostId);
                if (post) {
                    post.status = 'published';
                    post.published = new Date().toISOString();

                    // ë°œí–‰ ì‹œ slug ì—…ë°ì´íŠ¸ (ë°œí–‰ ë‚ ì§œ ê¸°ì¤€)
                    post.slug = generateSlug(post.title, post.published);

                    savePostToStorage(post);

                    // HTML íŒŒì¼ ìƒì„±
                    await generateHTMLFile(post);

                    showPublishSuccess(post.slug + '.html');
                    refreshBlogList();
                }
            }
        }

        // HTML íŒŒì¼ ìƒì„± ë° ì—…ë¡œë“œ
        async function generateHTMLFile(post) {
            const filename = `${post.slug}.html`;

            const htmlContent = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${post.title} - MUMULAB</title>
    <meta name="description" content="${post.summary}">
    <meta name="keywords" content="${post.tags.join(', ')}">
    <link rel="stylesheet" href="../../style.css">
    <style>
        .blog-post {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
            background: #fff;
            color: #333;
        }
        .post-meta {
            color: #666;
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }
        h1, h2, h3 { color: #2563eb; }
        h2 { border-bottom: 2px solid #e5e7eb; padding-bottom: 0.5rem; margin-top: 2rem; }
        ul { margin-left: 1.5rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
    </style>
</head>
<body>
    <div class="blog-post">
        <header>
            <h1>${post.title}</h1>
            <div class="post-meta">
                <span>ğŸ“… ${new Date(post.published || post.created).toLocaleDateString('ko-KR')}</span>
                <span>ğŸ“‚ ${post.category}</span>
                <span>â­ ${post.difficulty}</span>
            </div>
        </header>
        <main>
            ${post.content}
        </main>
        <footer>
            <br><hr><br>
            <p>ğŸ·ï¸ <strong>íƒœê·¸:</strong> ${post.tags.join(', ')}</p>
            <a href="../index.html">â† ë¸”ë¡œê·¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </footer>
    </div>
</body>
</html>`;

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— íŒŒì¼ ì •ë³´ ì €ì¥ (GitHub Actionsê°€ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡)
            const blogFiles = JSON.parse(localStorage.getItem('mumulab_blog_files') || '[]');
            const fileInfo = {
                filename: filename,
                content: htmlContent,
                post: post,
                created: new Date().toISOString()
            };

            blogFiles.push(fileInfo);
            localStorage.setItem('mumulab_blog_files', JSON.stringify(blogFiles));

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ (ë°±ì—…ìš©)
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // GitHubì— íŒŒì¼ ì—…ë¡œë“œ ì‹œë„
            try {
                await uploadToGitHub(filename, htmlContent, post);
            } catch (error) {
                console.log('GitHub ì—…ë¡œë“œ ì‹¤íŒ¨, ìˆ˜ë™ ì—…ë¡œë“œ í•„ìš”:', error);
                showUploadInstructions(filename);
            }
        }

        // GitHubì— íŒŒì¼ ì—…ë¡œë“œ
        async function uploadToGitHub(filename, content, post) {
            // í˜„ì¬ëŠ” GitHub API í† í°ì´ ì—†ìœ¼ë¯€ë¡œ ì‹œë®¬ë ˆì´ì…˜
            // ì‹¤ì œ êµ¬í˜„ ì‹œ GitHub Personal Access Token í•„ìš”
            throw new Error('GitHub API ì—…ë¡œë“œëŠ” ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ë°œí–‰ ì„±ê³µ ì•Œë¦¼
        function showPublishSuccess(filename) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4 text-green-600">ğŸ‰ í¬ìŠ¤íŠ¸ ë°œí–‰ ì™„ë£Œ!</h3>
                    <p class="mb-4">í¬ìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    <div class="bg-blue-50 p-3 rounded mb-4">
                        <p class="text-sm"><strong>ğŸ“ íŒŒì¼:</strong> ${filename}</p>
                        <p class="text-sm"><strong>ğŸ“‹ ìƒíƒœ:</strong> ë¸”ë¡œê·¸ ëª©ë¡ì— ì¶”ê°€ë¨</p>
                    </div>
                    <div class="bg-yellow-50 p-3 rounded mb-4">
                        <p class="text-sm text-yellow-800">
                            <strong>âš ï¸ ì•ˆë‚´:</strong> ë‹¤ìš´ë¡œë“œëœ HTML íŒŒì¼ì„ <code>blog/posts/</code> í´ë”ì— ì—…ë¡œë“œí•˜ë©´ ì‹¤ì œ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">
                            í™•ì¸
                        </button>
                        <button onclick="window.open('../blog/index.html', '_blank')" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                            ë¸”ë¡œê·¸ ë³´ê¸°
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ìˆ˜ë™ ì—…ë¡œë“œ ì•ˆë‚´
        function showUploadInstructions(filename) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4">ğŸ“ íŒŒì¼ ì—…ë¡œë“œ ì•ˆë‚´</h3>
                    <p class="mb-4">ë‹¤ìš´ë¡œë“œëœ HTML íŒŒì¼ì„ ë‹¤ìŒ ê²½ë¡œì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”:</p>
                    <code class="bg-gray-100 p-2 rounded block mb-4">blog/posts/${filename}</code>
                    <p class="text-sm text-gray-600 mb-4">
                        íŒŒì¼ì´ ì—…ë¡œë“œë˜ë©´ ë¸”ë¡œê·¸ì—ì„œ í¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <div class="flex space-x-2">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                            í™•ì¸
                        </button>
                        <button onclick="openFileLocation()" class="flex-1 bg-gray-600 text-white py-2 px-4 rounded hover:bg-gray-700">
                            ë‹¤ìš´ë¡œë“œ í´ë” ì—´ê¸°
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ë‹¤ìš´ë¡œë“œ í´ë” ì—´ê¸° (ë¸Œë¼ìš°ì € ì œí•œìœ¼ë¡œ ì‹¤ì œë¡œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŒ)
        function openFileLocation() {
            alert('ë‹¤ìš´ë¡œë“œ í´ë”ì—ì„œ HTML íŒŒì¼ì„ ì°¾ì•„ blog/posts/ í´ë”ì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
        }

        // ì—ë””í„° ì´ˆê¸°í™”
        function clearEditor() {
            if (confirm('í˜„ì¬ ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì´ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('postTitle').value = '';
                document.getElementById('postCategory').value = 'AIìƒì‚°ì„±';
                document.getElementById('postTags').value = '';
                document.getElementById('postDifficulty').value = 'ì´ˆê¸‰';
                document.getElementById('postSummary').value = '';
                document.getElementById('contentEditor').innerHTML = '';
                currentPostId = null;
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬
        function savePostToStorage(post) {
            const posts = JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
            const existingIndex = posts.findIndex(p => p.id === post.id);

            if (existingIndex >= 0) {
                posts[existingIndex] = post;
            } else {
                posts.push(post);
            }

            localStorage.setItem('mumulab_blog_posts', JSON.stringify(posts));
        }

        function getPost(id) {
            const posts = JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
            return posts.find(p => p.id === id);
        }

        function getAllPosts() {
            return JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
        }

        function deletePost(id) {
            const posts = JSON.parse(localStorage.getItem('mumulab_blog_posts') || '[]');
            const filtered = posts.filter(p => p.id !== id);
            localStorage.setItem('mumulab_blog_posts', JSON.stringify(filtered));
        }

        // ë¸”ë¡œê·¸ ëª©ë¡ í‘œì‹œ
        function refreshBlogList() {
            const posts = getAllPosts().sort((a, b) => new Date(b.updated) - new Date(a.updated));
            const container = document.getElementById('blogListContainer');

            if (posts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">ì €ì¥ëœ ë¸”ë¡œê·¸ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            container.innerHTML = posts.map(post => `
                <div class="border border-gray-200 rounded-lg p-4 mb-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-lg font-semibold text-gray-800">${post.title}</h3>
                        <span class="px-2 py-1 text-xs rounded ${post.status === 'published' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}">
                            ${post.status === 'published' ? 'ë°œí–‰ë¨' : 'ì„ì‹œì €ì¥'}
                        </span>
                    </div>

                    <div class="text-sm text-gray-600 mb-2">
                        <span>ğŸ“‚ ${post.category}</span> |
                        <span>â­ ${post.difficulty}</span> |
                        <span>ğŸ“… ${new Date(post.updated).toLocaleDateString('ko-KR')}</span>
                    </div>

                    <p class="text-gray-700 text-sm mb-3">${post.summary || 'ìš”ì•½ì´ ì—†ìŠµë‹ˆë‹¤.'}</p>

                    <div class="flex gap-2">
                        <button onclick="editPost('${post.id}')" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">
                            âœï¸ í¸ì§‘
                        </button>
                        <button onclick="duplicatePost('${post.id}')" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600">
                            ğŸ“‹ ë³µì‚¬
                        </button>
                        <button onclick="deletePostConfirm('${post.id}')" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">
                            ğŸ—‘ï¸ ì‚­ì œ
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // í¬ìŠ¤íŠ¸ í¸ì§‘
        function editPost(id) {
            const post = getPost(id);
            if (post) {
                document.getElementById('postTitle').value = post.title;
                document.getElementById('postCategory').value = post.category;
                document.getElementById('postTags').value = post.tags.join(', ');
                document.getElementById('postDifficulty').value = post.difficulty;
                document.getElementById('postSummary').value = post.summary;
                document.getElementById('contentEditor').innerHTML = post.content;

                currentPostId = id;
                switchTab('edit');
            }
        }

        // í¬ìŠ¤íŠ¸ ë³µì‚¬
        function duplicatePost(id) {
            const post = getPost(id);
            if (post) {
                const newPost = {
                    ...post,
                    id: Date.now().toString(),
                    title: post.title + ' (ë³µì‚¬ë³¸)',
                    created: new Date().toISOString(),
                    updated: new Date().toISOString(),
                    status: 'draft'
                };
                delete newPost.published;

                savePostToStorage(newPost);
                refreshBlogList();
                alert('í¬ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í¬ìŠ¤íŠ¸ ì‚­ì œ í™•ì¸
        function deletePostConfirm(id) {
            const post = getPost(id);
            if (post && confirm(`"${post.title}" ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                deletePost(id);
                refreshBlogList();

                if (currentPostId === id) {
                    clearEditor();
                }
            }
        }

        // ê¸€ ëª©ë¡ í‘œì‹œ (íƒ­ì—ì„œ í˜¸ì¶œ)
        function showBlogList() {
            switchTab('list');
        }
    </script>
</body>
</html>